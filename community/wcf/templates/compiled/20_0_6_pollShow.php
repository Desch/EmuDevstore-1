<?php
/**
* WoltLab Community Framework
* Template: pollShow
* Compiled at: Tue, 13 Aug 2013 17:19:31 +0000
* 
* DO NOT EDIT THIS FILE
*/
$this->v['tpl']['template'] = 'pollShow';
?>
<?php
if (!isset($this->pluginObjects['TemplatePluginFunctionCycle'])) {
require_once(WCF_DIR.'lib/system/template/plugin/TemplatePluginFunctionCycle.class.php');
$this->pluginObjects['TemplatePluginFunctionCycle'] = new TemplatePluginFunctionCycle;
}
if (!isset($this->pluginObjects['TemplatePluginModifierTime'])) {
require_once(WCF_DIR.'lib/system/template/plugin/TemplatePluginModifierTime.class.php');
$this->pluginObjects['TemplatePluginModifierTime'] = new TemplatePluginModifierTime;
}
?><?php if (isset($this->v['polls'])) { ?>
	<?php $this->assign("poll", $this->v['polls']->getPoll($this->v['pollID'])); ?>

	<?php if ($this->v['poll']) { ?>
		<div class="poll" id="poll<?php echo $this->v['pollID']; ?>">
			<div class="border pollShowResults<?php if ($this->v['poll']->canVote() &&  ! $this->v['poll']->voted) { ?> hidden<?php } ?>">
				<div class="container-3 pollQuestion">
					<div class="containerIcon"><img src="<?php echo StyleManager::getStyle()->getIconPath('pollM.png'); ?>" alt="" title="Poll" /></div>
					<div class="containerContent">
						<h4><a href="index.php?page=PollOverview&amp;pollID=<?php echo $this->v['poll']->pollID; ?><?php echo SID_ARG_2ND; ?>"><?php echo StringUtil::encodeHTML($this->v['poll']->question); ?></a></h4>
						<p class="smallFont"><?php if ($this->v['poll']->votes == 0) { ?>No votes have been recorded yet<?php } else { ?>A total of <?php echo StringUtil::formatNumeric($this->v['poll']->votes); ?> Vote<?php if ($this->v['poll']->votes == 1) { ?> has<?php } else { ?>s have<?php } ?> been submitted.<?php } ?></p>
					</div>
				</div>
				<?php echo $this->pluginObjects['TemplatePluginFunctionCycle']->execute(array('name' => 'barColor', 'values' => '1,2,3,4,5,6,7,8,9,10', 'print' => false, 'advance' => false, 'reset' => true), $this); ?>
				<?php
if (count($this->v['poll']->getSortedPollOptions()) > 0) {
foreach ($this->v['poll']->getSortedPollOptions() as $this->v['pollOption']) {
?>
					<div class="container-<?php echo $this->pluginObjects['TemplatePluginFunctionCycle']->execute(array('values' => "1,2"), $this); ?><?php if ($this->v['pollOption']->isChecked()) { ?> pollOptionChecked<?php } ?>">
						<div class="containerIcon">
							<p class="smallFont"><?php echo round($this->v['pollOption']->getPercent(),0); ?>%</p>
						</div>
						<div class="containerContent">
							<?php if ($this->v['pollOption']->getBarWidth() > 0) { ?><div class="pollOptionBar pollBarColor<?php echo $this->pluginObjects['TemplatePluginFunctionCycle']->execute(array('name' => 'barColor'), $this); ?>" style="width: <?php echo $this->v['pollOption']->getBarWidth(); ?>%"></div><?php } ?>
							<p class="smallFont pollOption"><?php echo StringUtil::encodeHTML($this->v['pollOption']->pollOption); ?><?php if ($this->v['pollOption']->votes) { ?> (<?php echo StringUtil::formatNumeric($this->v['pollOption']->votes); ?>)<?php } ?></p>
						</div>
					</div>
				<?php } } ?>
				
				<div class="container-3 pollResults">
					<?php if ($this->v['poll']->canVote()) { ?>
						<input type="submit" class="pollChangeButton" value="<?php if ($this->v['poll']->voted) { ?>Change vote<?php } else { ?>Vote<?php } ?>" />
					<?php } ?>
					<input type="button" value="Details" onclick="document.location.href=fixURL('index.php?page=PollOverview&amp;pollID=<?php echo $this->v['poll']->pollID; ?><?php echo SID_ARG_2ND; ?>')" />
				</div>
			</div>
		
			<?php if ($this->v['poll']->canVote()) { ?>
				<form method="post">
					<div class="border pollShowForm<?php if ($this->v['poll']->voted) { ?> hidden<?php } ?>">
						<div class="container-3 pollQuestion">
							<div class="containerIcon"><img src="<?php echo StyleManager::getStyle()->getIconPath('pollM.png'); ?>" alt="" title="Poll" /></div>
							<div class="containerContent">
								<h4><a href="index.php?page=PollOverview&amp;pollID=<?php echo $this->v['poll']->pollID; ?><?php echo SID_ARG_2ND; ?>"><?php echo StringUtil::encodeHTML($this->v['poll']->question); ?></a></h4>
								
								<?php if ($this->v['poll']->choiceCount > 1 && $this->v['poll']->choiceCount < count($this->v['poll']->getPollOptions())) { ?>
									<p class="smallFont">Available choices for this poll are <?php echo StringUtil::formatNumeric($this->v['poll']->choiceCount); ?></p>
								<?php } ?>
								
								<?php if ($this->v['poll']->endTime > 0) { ?>
									<p class="smallFont">Poll completion date: <?php echo $this->pluginObjects['TemplatePluginModifierTime']->execute(array($this->v['poll']->endTime), $this); ?></p>
								<?php } ?>
								
								<?php if ($this->v['poll']->voted) { ?>
									<p class="smallFont">You have already voted, but you can change your vote.</p>
								<?php } ?>
								<?php if (isset($this->v['activePollID']) && $this->v['activePollID'] == $this->v['pollID'] && $this->v['errorField'] == 'pollOptionID') { ?>
									<p class="innerError smallFont">
										<?php if ($this->v['errorType'] == 'notValid') { ?>You have not chosen a valid answer for this poll. Please choose at least one of the available answers!<?php } ?>
										<?php if ($this->v['errorType'] == 'tooMuch') { ?>You have chosen too many answers for this poll. The maximum allowed votes for this poll is <?php echo StringUtil::formatNumeric($this->v['poll']->choiceCount); ?>.<?php } ?>
									</p>
								<?php } ?>
							</div>
						</div>
							
						<?php
if (count($this->v['poll']->getPollOptions()) > 0) {
foreach ($this->v['poll']->getPollOptions() as $this->v['pollOption']) {
?>
							<div class="container-<?php echo $this->pluginObjects['TemplatePluginFunctionCycle']->execute(array('values' => "1,2"), $this); ?>">
								<div class="containerIcon">
									<input id="pollOption<?php echo $this->v['pollOption']->pollOptionID; ?>" <?php if ($this->v['poll']->choiceCount > 1) { ?>type="checkbox" name="pollOptionID[]"<?php } else { ?>type="radio" name="pollOptionID"<?php } ?> value="<?php echo $this->v['pollOption']->pollOptionID; ?>" <?php if ($this->v['pollOption']->isChecked()) { ?>checked="checked" <?php } ?>/>
								</div>
								<div class="containerContent"><label for="pollOption<?php echo $this->v['pollOption']->pollOptionID; ?>" class="smallFont"><?php echo StringUtil::encodeHTML($this->v['pollOption']->pollOption); ?></label></div>
							</div>
						<?php } } ?>
						
						<div class="container-3 pollResults">
							<input type="submit" name="votePoll" value="Submit" />
							<input type="submit" class="pollShowButton" value="Results" />
							<input type="button" value="Details" onclick="document.location.href=fixURL('index.php?page=PollOverview&amp;pollID=<?php echo $this->v['poll']->pollID; ?><?php echo SID_ARG_2ND; ?>')" />
							<?php echo SID_INPUT_TAG; ?>
							<input type="hidden" name="pollID" value="<?php echo $this->v['pollID']; ?>" />
						</div>					
					</div>
				</form>
			<?php } ?>
		</div>
		<script type="text/javascript">
			//<![CDATA[
			new Poll(<?php echo $this->v['pollID']; ?><?php if ($this->v['poll']->choiceCount > 1) { ?>, {
				'choiceCount' : <?php echo $this->v['poll']->choiceCount; ?>, 
				'pollOptionIDs' : new Array(<?php
$_length332687d6230468d77db04d9b14a786d73daa969c = count($this->v['poll']->getPollOptions());
$_i332687d6230468d77db04d9b14a786d73daa969c = 0;
foreach ($this->v['poll']->getPollOptions() as $this->v['pollOption']) { ?><?php echo $this->v['pollOption']->pollOptionID; ?><?php
if (++$_i332687d6230468d77db04d9b14a786d73daa969c < $_length332687d6230468d77db04d9b14a786d73daa969c) { echo ', '; }
} ?>)
				}<?php } ?>
			);
			//]]>
		</script>
	<?php } ?>
<?php } ?>